<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="CMI103">
  <resultMap class="com.yondervision.mi.dto.Mi103" id="abatorgenerated_Mi103Result">
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Thu Sep 26 10:13:18 CST 2013.
    -->
    <result column="USER_ID" jdbcType="VARCHAR" property="userId" />
    <result column="USERPWD" jdbcType="VARCHAR" property="userpwd" />
    <result column="CENTERID" jdbcType="CHAR" property="centerid" />
    <result column="ACCNUM" jdbcType="VARCHAR" property="accnum" />
    <result column="ACCNAME" jdbcType="VARCHAR" property="accname" />
    <result column="CERTINUM" jdbcType="VARCHAR" property="certinum" />
    <result column="EMAIL" jdbcType="VARCHAR" property="email" />
    <result column="CARDNO" jdbcType="VARCHAR" property="cardno" />
    <result column="VALIDFLAG" jdbcType="CHAR" property="validflag" />
    <result column="DATEMODIFIED" jdbcType="CHAR" property="datemodified" />
    <result column="DATECREATED" jdbcType="CHAR" property="datecreated" />
    <result column="FREEUSE1" jdbcType="VARCHAR" property="freeuse1" />
    <result column="FREEUSE2" jdbcType="VARCHAR" property="freeuse2" />
    <result column="FREEUSE3" jdbcType="CHAR" property="freeuse3" />
    <result column="FREEUSE4" jdbcType="INTEGER" property="freeuse4" />
  </resultMap>
  <resultMap class="java.util.HashMap" id="WebApi10304Map">
    <result column="COUNTNUM" jdbcType="VARCHAR" property="countnum" />
    <result column="CREATEDATE" jdbcType="VARCHAR" property="createdate" />
    <result column="SUMCOUNT" jdbcType="VARCHAR" property="sumcount" />
  </resultMap>
  <resultMap class="java.util.HashMap" id="WebApi10304MapAll">
    <result column="WXCOUNTNUM" jdbcType="VARCHAR" property="wxcountnum" />
    <result column="WXCREATEDATE" jdbcType="VARCHAR" property="wxcreatedate" />
    <result column="WXSUMCOUNT" jdbcType="VARCHAR" property="wxsumcount" />
    <result column="APPCOUNTNUM" jdbcType="VARCHAR" property="appcountnum" />
    <result column="APPCREATEDATE" jdbcType="VARCHAR" property="appcreatedate" />
    <result column="APPSUMCOUNT" jdbcType="VARCHAR" property="appsumcount" />
  </resultMap>
  <resultMap class="java.util.HashMap" id="WebApi10304MapCenter">
    <result column="COUNTNUM" jdbcType="VARCHAR" property="countnum" />
    <result column="SUMCOUNT" jdbcType="VARCHAR" property="sumcount" />
    <result column="CENTERID" jdbcType="VARCHAR" property="centerid" />
  </resultMap>
  <select id="selectWebMi103" parameterClass="com.yondervision.mi.dto.CMi103" resultMap="abatorgenerated_Mi103Result" >
    SELECT
      USER_ID,
      USERPWD,
      CENTERID,
      ACCNUM,
      ACCNAME,
      CERTINUM,
      EMAIL,
      CARDNO,      
      VALIDFLAG,
      DATEMODIFIED,
      DATECREATED,
      FREEUSE1,
      FREEUSE2,
      FREEUSE3,
      FREEUSE4
    FROM
      mi103
    <dynamic prepend="where" >
	  <isNotEmpty prepend="and" property="accnum">
	    mi103.ACCNUM = #accnum:CHAR#
	  </isNotEmpty>
	  <isNotEmpty prepend="and" property="centerId">
	    mi103.CENTERID = #centerId:CHAR#
	  </isNotEmpty>
	  <isNotEmpty prepend="and" property="accname">
	    mi103.ACCNAME = #accname:CHAR#
	  </isNotEmpty>
	  <isNotEmpty prepend="and" property="certinum">
	    mi103.CERTINUM =  #certinum:CHAR#
	  </isNotEmpty>
	  <isNotEmpty prepend="and" property="email">
	    mi103.EMAIL = #email:CHAR#  
	  </isNotEmpty>
	  <isNotEmpty prepend="and" property="cardno">
	    mi103.CARDNO = #cardno:CHAR#  
	  </isNotEmpty>
	  <isNotEmpty prepend="and" property="startdate">
	    mi103.DATECREATED >= #startdate:CHAR#  
	  </isNotEmpty>	 
	  <isNotEmpty prepend="and" property="enddate">
	    mi103.DATECREATED &lt; #enddate:CHAR#  
	  </isNotEmpty> 	
	  <isNotEmpty prepend="and" property="validflag">
	    mi103.VALIDFLAG = #validflag:CHAR#
	  </isNotEmpty>	  
    </dynamic>
  </select> 
  <select id="selectWebApiAppuser" parameterClass="com.yondervision.mi.dto.CMi103" resultMap="WebApi10304Map">
  	select countnum,createdate,(select count(*) from mi103 
  	where 
  	<![CDATA[SUBSTR(datecreated,1,10)<=createdate]]> and validflag='1'
  	<isNotEqual prepend="and" property="centerId" compareValue="00000000">
	    CENTERID= #centerId:VARCHAR#
	  </isNotEqual>
	  <!-- and  CENTERID= #centerId:VARCHAR#-->
	  ) sumcount from
	(select count(*) countnum,SUBSTR(datecreated,1,10) createdate from mi103 
	where validflag='1'
	  <isNotEqual prepend="and" property="centerId" compareValue="00000000">
	    CENTERID= #centerId:VARCHAR#
	  </isNotEqual>
	group by SUBSTR(datecreated,1,10)
	having SUBSTR(datecreated,1,10)>=#startdate:VARCHAR#
	and <![CDATA[SUBSTR(datecreated,1,10) <= #enddate:VARCHAR#]]>)
	order by createdate
  </select>
   <select id="selectWebApiWxuser" parameterClass="com.yondervision.mi.dto.CMi103" resultMap="WebApi10304Map">
  	select countnum,createdate,(select count(*) from mi110 where 
  	<![CDATA[SUBSTR(datecreated,1,10)<=createdate]]>  and CHANNEL='20' and bindflag='1' and validflag='1'
	<isNotEqual prepend="and" property="centerId" compareValue="00000000">
	    CENTERID= #centerId:VARCHAR#
	  </isNotEqual>
	  <!-- and  CENTERID= #centerId:VARCHAR#-->
	  ) sumcount from
	(select count(*) countnum,SUBSTR(datecreated,1,10) createdate from mi110 where CHANNEL='20' and bindflag='1' and validflag='1'
	<isNotEqual prepend="and" property="centerId" compareValue="00000000">
	    CENTERID= #centerId:VARCHAR#
	  </isNotEqual>
	  <!-- and  CENTERID= #centerId:VARCHAR#--> 
	group by SUBSTR(datecreated,1,10)
	having SUBSTR(datecreated,1,10)>=#startdate:VARCHAR#
	<![CDATA[and SUBSTR(datecreated,1,10) <= #enddate:VARCHAR#]]>
	)
	order by createdate
 </select>
 <select id="selectWebApiAll" parameterClass="com.yondervision.mi.dto.CMi103" resultMap="WebApi10304MapAll">
  	select wxcountnum,wxcreatedate,(select count(*) from mi110 where <![CDATA[SUBSTR(datecreated,1,10)<=wxcreatedate]]> and 
  	 CHANNEL='20' and bindflag='1' and validflag='1'
  	<isNotEqual prepend="and" property="centerId" compareValue="00000000">
	    CENTERID= #centerId:VARCHAR#
	  </isNotEqual>
	  <!-- and  CENTERID= #centerId:VARCHAR#--> ) wxsumcount,appcountnum,appcreatedate,(select count(*) from mi103 
  	where  <![CDATA[SUBSTR(datecreated,1,10)<=appcreatedate]]> and validflag='1'
  	<isNotEqual prepend="and" property="centerId" compareValue="00000000">
	    CENTERID= #centerId:VARCHAR#
	  </isNotEqual>
	  <!-- and  CENTERID= #centerId:VARCHAR#-->) appsumcount from (select count(*) wxcountnum,
  	SUBSTR(datecreated,1,10) wxcreatedate from mi110 where  CHANNEL='20' and bindflag='1' and validflag='1'
	<isNotEqual prepend="and" property="centerId" compareValue="00000000">
	    CENTERID= #centerId:VARCHAR#
	  </isNotEqual>
	  <!-- and  CENTERID= #centerId:VARCHAR#--> 
  	group by SUBSTR(datecreated,1,10) having SUBSTR(datecreated,1,10)>=#startdate:VARCHAR# and 
  	<![CDATA[ SUBSTR(datecreated,1,10) <= #enddate:VARCHAR#]]>) full join 
  	(select count(*) appcountnum,SUBSTR(datecreated,1,10) appcreatedate 
  	from mi103 where validflag='1' 
	<isNotEqual prepend="and" property="centerId" compareValue="00000000">
	  CENTERID= #centerId:VARCHAR#
	  </isNotEqual>
	group by SUBSTR(datecreated,1,10) having SUBSTR(datecreated,1,10)>=#startdate:VARCHAR# and  
  	<![CDATA[ SUBSTR(datecreated,1,10) <= #enddate:VARCHAR#]]>) on wxcreatedate=appcreatedate order by wxcreatedate,appcreatedate
	
 </select>
  <select id="selectWebApi10301wx" parameterClass="com.yondervision.mi.dto.CMi103" resultMap="WebApi10304MapCenter">
  	select centerid1 as centerid,countnum,(select count(*) from mi110 where 
  	<![CDATA[SUBSTR(datecreated,1,10)<=#enddate:VARCHAR#]]>  and CHANNEL='20' and bindflag='1' and validflag='1'
	and  CENTERID =centerid1) sumcount from
	(select count(*) countnum,centerid as centerid1 from mi110 where CHANNEL='20' and bindflag='1' and validflag='1'
	and  CENTERID in ($centerlist$) and SUBSTR(datecreated,1,10)>=#startdate:VARCHAR#
	<![CDATA[and SUBSTR(datecreated,1,10) <= #enddate:VARCHAR#]]>
	group by centerid) order by centerid1
 </select>
 <select id="selectWebApi10301app" parameterClass="com.yondervision.mi.dto.CMi103" resultMap="WebApi10304MapCenter">
  	select centerid1 as centerid,countnum,(select count(*) from mi103 where 
  	<![CDATA[SUBSTR(datecreated,1,10)<=#enddate:VARCHAR#]]>  and validflag='1'
	and  CENTERID =centerid1) sumcount from
	(select count(*) countnum,centerid as centerid1 from mi103 
	where validflag='1' and  CENTERID in ( $centerlist$ ) and SUBSTR(datecreated,1,10)>=#startdate:VARCHAR#
	<![CDATA[and SUBSTR(datecreated,1,10) <= #enddate:VARCHAR#]]>
	group by centerid ) order by centerid1
 </select>
</sqlMap>